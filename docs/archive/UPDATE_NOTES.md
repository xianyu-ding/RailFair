# 更新说明 - 少量多次策略

## 修改内容

### 核心改变
- ✅ **一次只处理一个组合**: 一个路由 × 一个日期块（≤7天）× 一个天数类型
- ✅ **立即保存**: 处理完一个组合后立即保存数据，不累积
- ✅ **请求间隔**: 每个请求间隔 3-5 秒（自动控制）

### 工作流程

**之前**（有问题）:
```
路由1 → 所有日期块 × 所有天数类型 → 保存
路由2 → 所有日期块 × 所有天数类型 → 保存
...
```

**现在**（正确）:
```
路由1 | 日期块1 | WEEKDAY → 请求 → 保存
路由1 | 日期块1 | SATURDAY → 请求 → 保存
路由1 | 日期块1 | SUNDAY → 请求 → 保存
路由1 | 日期块2 | WEEKDAY → 请求 → 保存
...
路由2 | 日期块1 | WEEKDAY → 请求 → 保存
...
```

### 示例

对于 Phase 1:
- 10 个路由
- 9 个日期块（62天 ÷ 7天）
- 3 个天数类型（WEEKDAY, SATURDAY, SUNDAY）
- **总计**: 270 个任务

每个任务:
1. 发送一个 API 请求（一个路由的一个日期块的一个天数类型）
2. 等待 3-5 秒（自动）
3. 处理响应并立即保存
4. 继续下一个任务

## 优势

1. **避免超时**: 每个请求只处理 ≤7 天的数据
2. **避免限速**: 每次请求间隔 3-5 秒
3. **错误隔离**: 一个任务失败不影响其他任务
4. **进度可见**: 每个任务完成后立即看到结果

## 使用

无需改变使用方式，直接运行：

```bash
./run_phase1_background.sh
```

代码会自动按照新的策略运行。

