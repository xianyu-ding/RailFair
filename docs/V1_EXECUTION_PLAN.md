# RailFair V1 完整执行计划表

## 总目标
- **目标**：4 周内上线 MVP，启动数据飞轮，获取首批 100 位用户

---

## 📊 Week 1：数据基础建设

### 里程碑
- ✅ 数据库 ≥ 10,000 条历史记录
- ✅ 覆盖 10 条热门路线
- ✅ 数据质量验证通过
- ✅ 统计缓存表建立

### 日程与任务

| 日期 | 任务 | 交付物 | 预计工时 | 成功标准 | 风险 / 备注 |
| ---- | ---- | ------ | -------- | -------- | ----------- |
| Day 1 | 环境搭建 | Python 3.11+ 虚拟环境、项目结构、依赖安装、Git 初始化、NRDP API 调用样本 | 4h | `python --version` 显示 3.11+，项目结构完整，API 成功返回数据 | 网络波动、凭据配置 |
| Day 2 | 数据库设计 | `database_schema.sql`、`railfair.db`、`models.py`、`test_database.py` | 6h | Schema 完整，索引可用，`pytest` 通过 | `data/` 目录存在，测试数据插入成功 |
| Day 3 | HSP 数据采集 (1) | `fetch_hsp.py` 初版、EUS-MAN 路线入库 | 6h | 处理单条路线，分页正确，错误重试与日志完善 | API 限流、时区处理 |
| Day 4 | HSP 数据采集 (2) | 10 条路线历史数据 (~15k 记录) | 8h | 路线全覆盖、数据去重、历史数据>10k | 需长时间运行，限流风险 |
| Day 5 | 数据验证 | KB 元数据、TOC 补偿规则、`validate_data.py` | 4h | 验证报告通过，无严重警告 | 数据来源补齐 |
| Day 6-7 | 统计预计算 | `calculate_stats.py`、`route_statistics` 表、CRON 配置、README 更新 | 6h | 准点率计算准确，缓存命中率>10x，文档清晰 | 手动运行验证 |

---

## 📊 Week 2：预测引擎 + API 开发

### 里程碑
- ✅ 预测 API 可用
- ✅ 准确率 ≥ 70%
- ✅ 响应时间 < 200ms
- ✅ 数据收集埋点完成

### 日程与任务

| 日期 | 任务 | 交付物 | 预计工时 | 成功标准 | 风险 / 备注 |
| ---- | ---- | ------ | -------- | -------- | ----------- |
| Day 8 | 核心预测逻辑 | `predictor.py`、`test_predictor.py` | 8h | 模型可用，缓存命中，样本不足时优雅降级 | 覆盖率>80%，响应<100ms |
| Day 9 | 价格对比 | `price_fetcher.py`、缓存机制 | 6h | 能获取并缓存价格 | API 不稳定，必要时模拟数据 |
| Day 10 | FastAPI 后端 (1) | `main.py`、Pydantic Schemas、预测端点、健康检查、Swagger | 8h | API 启动成功，`/health` 正常 | CORS、本地调试 |
| Day 11 | FastAPI 后端 (2) | 反馈端点、指纹追踪、速率限制、统一错误、中间件集成测试 | 8h | 端到端 `pytest` 通过，100 req/min 限速 | 错误监控及时捕获 |
| Day 12 | 推荐算法 | 性价比打分、用户偏好、替代方案逻辑、A/B 框架 | 6h | 返回多种推荐，权重可调 | 需要真实数据校验 |
| Day 13-14 | API 优化与文档 | 性能优化、缓存层、API 文档、Postman 集合、代码清理 | 8h | p95 响应 <200ms，命中率>50%，文档完善 | 代码质量维护 |

---

## 📊 Week 3：前端开发 + 数据收集

### 里程碑
- ✅ 完整用户流程可用
- ✅ 移动端适配完成
- ✅ 数据埋点完备
- ✅ Lighthouse 分数 >85

### 日程与任务

| 日期 | 任务 | 交付物 | 预计工时 | 成功标准 | 风险 / 备注 |
| ---- | ---- | ------ | -------- | -------- | ----------- |
| Day 15 | 前端项目初始化 | Next.js 14 项目、Tailwind、API Client、基础布局 | 6h | `npm run dev` 正常，布局响应式 | 环境变量配置 |
| Day 16 | 搜索表单组件 | 站点选择、日期时间控件、表单校验、Loading、错误处理 | 8h | 交互友好，可移动端使用 | 自动完成数据依赖 |
| Day 17 | 结果展示组件 | 结果卡片、准点率展示、价格高亮、标签、解释文本、折叠详情 | 8h | 信息清晰，三种状态支持 | 视觉统一，数据准确 |
| Day 18 | 交互与动画 | 页面切换、排序、分享、返回修改 | 6h | 动画流畅，排序可用，分享集成 | 控制动画开销 |
| Day 19 | 数据埋点 | 指纹识别、查询事件、反馈追踪、本地存储、Plausible、Sentry | 8h | 数据上传成功，错误监控可用 | 隐私合规 |
| Day 20-21 | 产品完善 | About/FAQ/Privacy/Contact/404、SEO、性能与可访问性优化 | 10h | Lighthouse >90，A11y 通过 | 内容撰写与测试 |

---

## 📊 Week 4：部署上线 + 营销启动

### 里程碑
- ✅ 产品公开上线
- ✅ 查询 ≥100 次
- ✅ Reddit Upvotes ≥50
- ✅ 首批真实反馈收集
- ✅ 准确率验证完成

### 日程与任务

| 日期 | 任务 | 交付物 | 预计工时 | 成功标准 | 风险 / 备注 |
| ---- | ---- | ------ | -------- | -------- | ----------- |
| Day 22 | 部署准备 | Dockerfile、`.env.production`、备份脚本、Railway/Render 部署、SSL、健康检查、`DEPLOY.md` | 8h | API 稳定，HTTPS 正常 | 选择合适免费方案 |
| Day 23 | 前端部署 | Vercel 流水线、域名、生产测试、监控 | 6h | `railfair.uk` 可访问，端到端通过 | DNS 生效可能延迟 |
| Day 24 | 上线前检查 | 安全/限流/压力测试、错误监控、移动端测试、回滚预案 | 8h | 无严重漏洞，多端兼容 | 压测资源准备 |
| Day 25 | 内容准备 | Reddit/Twitter/HN 文案、截图、视频、FAQ、推文计划 | 8h | 素材完备，风格一致 | HN 时区注意 |
| Day 26 | 🚀 正式发布 | 多平台发布、实时监控、修复紧急问题、反馈收集、总结与计划 | 10h | 服务不中断，反馈整理及时 | 高流量风险 |
| Day 27 | 迭代改进 | Bug 修复、FAQ 更新、数据分析、社区互动、博客文章 | 8h | 修复 Top3 Bug，保持活跃 | 优先级管理 |
| Day 28 | Week 4 总结 | 数据回填验证、准确率报告、总结文档、V2 规划、庆祝 | 6h | 准确率 ≥70%，V2 目标明确 | 时间留给复盘 |

---

## 📊 关键指标追踪

| 指标 | Week 1 | Week 2 | Week 3 | Week 4 | 目标 |
| ---- | ------ | ------ | ------ | ------ | ---- |
| 开发进度 | 数据基础 | 后端完成 | 前端完成 | 上线 | 100% |
| 代码量 | 500 行 | 2000 行 | 3500 行 | 4000 行 | —— |
| 测试覆盖率 | 0% | 60% | 70% | 75% | >70% |
| 数据记录数 | 15k | 15k | 15k | 15k+ | >10k |
| API 响应时间 | —— | 180ms | 150ms | 120ms | <200ms |
| 用户数 | 0 | 0 | 5 (测试) | 100+ | >50 |
| 查询量 | 0 | 0 | 20 | 500+ | >100 |
| 准确率 | —— | 72% (估算) | 72% | 74% (验证) | >70% |

---

## ⚠️ 风险管理矩阵

| 风险 | 概率 | 影响 | 应对策略 | 阶段 |
| ---- | ---- | ---- | -------- | ---- |
| NRDP API 限流 | 高 | 高 | 批量请求 + 重试 + 缓存 | Week 1 |
| 数据量不足 | 中 | 高 | 扩大日期范围至 120 天 | Week 1 |
| Trainline API 变化 | 高 | 中 | V1 使用模拟数据并注明 | Week 2 |
| 预测准确率 <70% | 中 | 高 | 调整权重，接受 65% 过渡 | Week 2 |
| 前端性能问题 | 低 | 中 | 代码分割、懒加载 | Week 3 |
| 服务器宕机 | 中 | 高 | 监控、自动重启、备用方案 | Week 4 |
| Reddit 帖子被删 | 中 | 高 | 遵守规则，准备备用社区 | Week 4 |
| 无人使用产品 | 低 | 极高 | 多渠道推广、主动私信 | Week 4 |
| 法律/合规风险 | 低 | 高 | 添加免责声明、说明数据来源 | Week 3-4 |

---

## ✅ 每日检查清单

### 每日开始前
- [ ] 查看昨日遗留问题
- [ ] 明确今日 3 个以内优先任务
- [ ] 准备好常用 AI Prompt 模板
- [ ] 检查 NRDP API 状态

### 每日结束时
- [ ] Git commit 当日代码
- [ ] 更新任务看板进度
- [ ] 记录问题及解决方案
- [ ] 准备次日任务
- [ ] 记录工作时长，避免透支

### 每周结束时
- [ ] 自我或团队总结会议
- [ ] 更新计划表进度
- [ ] 调整下周优先级
- [ ] 备份代码和数据库

---

## 💡 成功建议

### 时间管理
- 🔴 高优先级：核心功能（预测 API、搜索流程、数据收集）
- 🟡 中优先级：性能优化、错误处理、测试
- 🟢 低优先级：视觉美化、动画、附加功能

### 质量 vs 速度
- Week 1-2：质量优先（数据打底）
- Week 3：兼顾功能与质量
- Week 4：速度优先，先上线再迭代

### AI 使用策略
- ✅ 让 AI 执行：模板代码、数据脚本、测试用例
- ⚠️ AI 辅助：算法逻辑、API 设计、UI 组件
- ❌ 必须人工：产品决策、用户体验、优先级排序

### 心态提示
- Day 1-7：数据工作枯燥，坚持住！
- Day 8-14：API 成果显现，保持兴奋！
- Day 15-21：前端繁琐期，循序推进！
- Day 22-28：上线冲刺，高压中保持自信！

---

> 若计划中有调整、新增内容或风险，请同步更新本文件，确保团队协同一致。祝项目顺利上线！ 🚀

